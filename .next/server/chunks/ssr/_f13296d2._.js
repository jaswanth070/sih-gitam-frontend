module.exports=[85358,(a,b,c)=>{"use strict";b.exports=a.r(60441).vendored["react-ssr"].ReactServerDOMTurbopackClient},11634,48561,a=>{"use strict";function b(a){return{...a}}function c(){}function d(a){b({leaderTeam:a})}function e(){return(void 0)??null}function f(a){b({pocTeams:a})}function g(){let a={};return Array.isArray(a.pocTeams)?a.pocTeams:[]}function h(a){a?.id&&b({pocTeamDetails:{...(void 0)??{},[a.id]:a}})}function i(a){return a?((void 0)??{})[a]??null:null}function j(a){b({adminTeams:a})}function k(){let a={};return Array.isArray(a.adminTeams)?a.adminTeams:[]}function l(a){let b=a.replace(/\/+$/,"");return b?(b.startsWith("/")||(b=`/${b}`),b.endsWith("/auth/api"))?b:b.endsWith("/auth")?`${b}/api`:b.endsWith("/api")?b:`${b}/auth/api`:"/auth/api"}a.s(["clearSessionCache",()=>c,"getStoredAdminTeams",()=>k,"getStoredLeaderTeam",()=>e,"getStoredPOCTeamDetail",()=>i,"getStoredPOCTeams",()=>g,"storeAdminTeams",()=>j,"storeLeaderTeam",()=>d,"storePOCTeamDetail",()=>h,"storePOCTeams",()=>f],48561);let m=function(){let a="https://sih.jaswanthmadiya.tech/auth/";if(a.startsWith("/"))return l(a);try{let b=new URL(a);return b.pathname=l(b.pathname),`${b.origin}${b.pathname}`}catch(a){return console.warn("[auth-service] invalid NEXT_PUBLIC_AUTH_SERVICE_URL, using default",a),"http://127.0.0.1:8000/auth/api"}}(),n=new class{accessTokenKey="sih_access_token";refreshTokenKey="sih_refresh_token";setTokens(a,b){}getAccessToken(){return null}getRefreshToken(){return null}clearTokens(){}async request(a,b={},c=0){let d=`${m}${a}`,e=new Headers(b.headers||{}),f=this.getAccessToken();f&&e.set("Authorization",`Bearer ${f}`);let g=await fetch(d,{...b,headers:e});if(401===g.status&&0===c){let c=this.getRefreshToken();if(c)try{return await this.refreshAccessToken(c),this.request(a,b,1)}catch(a){throw this.clearTokens(),Error("Session expired. Please login again.")}}if(!g.ok){let a=await g.json().catch(()=>({}));throw Error(a.detail||a.message||`API Error: ${g.status}`)}return g.json()}getCurrentUser(){return null}base64UrlDecode(a){let b=a.replace(/-/g,"+").replace(/_/g,"/"),c=b.length%4;return c&&(b+="=".repeat(4-c)),Buffer.from(b,"base64").toString("utf-8")}async login(a){let b=await this.request("/token/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});return this.setTokens(b.access,b.refresh),b}async refreshAccessToken(a){let b=(await this.request("/token/refresh/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh:a})})).access;return localStorage.setItem(this.accessTokenKey,b),b}async requestOTP(a){return this.request("/auth/send-otp/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:a,purpose:"first_login"})})}async verifyOTPAndSetPassword(a){return this.request("/auth/verify-otp/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})}async autoLogin(a,b){return this.login({email:a,password:b})}async getTeamDetails(a=!1){if(!a){let a=e();if(a)return a}let b=await this.request(a?"/leader/team/?preview=1":"/leader/team/");return a||d(b),b}async confirmTeamDetails(){return this.request("/leader/team/confirm/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})})}async getPOCTeams(){let a=g();if(a.length)return a;let b=await this.request("/poc/teams/");return f(b),b}async getPOCTeamDetail(a){let b=i(a);if(b)return b;let c=await this.request(`/poc/teams/${a}/`);return h(c),c}async getAdminTeams(){let a=k();if(a.length)return a;let b=await this.request("/admin/teams/");return j(b),b}async logout(){let a=this.getRefreshToken();if(!a)return this.clearTokens(),c(),{detail:"Logged out"};try{let b=await this.request("/auth/logout/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh:a})});return this.clearTokens(),c(),b}catch(a){return this.clearTokens(),c(),{detail:"Logged out"}}}async logoutAll(){try{let a=await this.request("/auth/logout_all/",{method:"POST",headers:{"Content-Type":"application/json"}});return this.clearTokens(),c(),a}catch(a){return this.clearTokens(),c(),{detail:"Logged out from all devices"}}}async initializeUserContext(a=!1){}};a.s(["authService",0,n],11634)},84120,4532,a=>{"use strict";var b=a.i(11634);let c="http://127.0.0.1:8001",d=`${c}/requests/api`;function e(a){let b=a.replace(/\/+$/,"");return b?(b.startsWith("/")||(b=`/${b}`),b.endsWith("/requests/api"))?b:b.endsWith("/requests")?`${b}/api`:b.endsWith("/api")?b.replace(/\/api$/,"/requests/api"):`${b}/requests/api`:"/requests/api"}function f(a){let b=e(a);return"/requests/api"===b?"/requests":b.replace(/\/api$/,"")||"/requests"}function g(){let a="https://sih.jaswanthmadiya.tech/requests/";if(a.startsWith("/"))return e(a);try{let b=new URL(a);return b.pathname=e(b.pathname),`${b.origin}${b.pathname}`}catch(a){return console.warn("[ws-url] invalid NEXT_PUBLIC_REQUESTS_SERVICE_URL, using default",a),d}}function h(a){try{let b=new URL("wss://sih.jaswanthmadiya.tech/ws/requests");return b.searchParams.set("token",a),b.toString()}catch(a){console.warn("[ws-url] invalid NEXT_PUBLIC_REQUESTS_WS_URL, falling back",a)}let b="https://sih.jaswanthmadiya.tech/requests/",d="",e="/requests";if(b.startsWith("http"))try{let a=new URL(b);d=a.origin,e=f(a.pathname)}catch(a){console.warn("[ws-url] invalid NEXT_PUBLIC_REQUESTS_SERVICE_URL, using defaults",a)}else e=f(b);d||(d=c);let g=d.startsWith("https://"),h=d.replace(/^https?:\/\//,""),i=`${e}/ws/requests/`;return(i=i.replace(/\/+/g,"/")).startsWith("/")||(i=`/${i}`),`${g?"wss":"ws"}://${h}${i}?token=${encodeURIComponent(a)}`}a.s(["buildRequestsBaseUrl",()=>g,"buildRequestsWsUrl",()=>h],4532);let i=g();async function j(a,c={}){let d=`${i}${a}`,e=new Headers(c.headers||{}),f=b.authService.getAccessToken();f&&!e.has("Authorization")&&e.set("Authorization",`Bearer ${f}`);let g=await fetch(d,{...c,headers:e});if(401===g.status){let a=b.authService.getRefreshToken();if(a)try{let b=await fetch(`${i}/token/refresh/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh:a})});if(b.ok){let{access:a}=await b.json();localStorage.setItem("sih_access_token",a),e.set("Authorization",`Bearer ${a}`),g=await fetch(d,{...c,headers:e})}}catch(a){b.authService.clearTokens(),window.location.href="/login"}}if(!g.ok){let a=await g.json().catch(()=>({}));throw Error(a.detail||a.message||`API Error: ${g.status}`)}return g.json()}a.s(["requestsService",0,{async listRequests(a){let b=new URLSearchParams;return a?.category&&b.append("category",a.category),a?.status&&b.append("status",a.status),a?.fab_type&&b.append("fab_type",a.fab_type),a?.team_id&&b.append("team_id",a.team_id),a?.search&&b.append("search",a.search),a?.ordering&&b.append("ordering",a.ordering),a?.page&&b.append("page",a.page.toString()),j(`/requests/?${b.toString()}`)},getQueueSnapshot:async(a=!0)=>j(`/requests/queue/?include_positions=${a}`),async getFilteredQueueSnapshot(a){let b=new URLSearchParams;return a.category&&b.append("category",a.category),a.status&&b.append("status",a.status),a.fab_type&&b.append("fab_type",a.fab_type),void 0!==a.include_positions&&b.append("include_positions",a.include_positions?"true":"false"),a.page&&b.append("page",a.page.toString()),a.page_size&&b.append("page_size",a.page_size.toString()),j(`/requests/queue/?${b.toString()}`)},getRequest:async a=>j(`/requests/${a}/`),createBOMRequest:async(a,b,c)=>j("/requests/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({team_id:a,category:"BOM",notes:b,bom_items:c})}),createAdditionalRequest:async(a,b,c)=>j("/requests/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({team_id:a,category:"ADDITIONAL",notes:b,additional_items:c})}),async createFabricationRequest(a,c,d,e){let f=new FormData;f.append("team_id",a),f.append("category","FABRICATION"),f.append("notes",c),f.append("fabrication",JSON.stringify(d)),e&&f.append("file",e);let g=b.authService.getAccessToken(),h=new Headers;g&&h.set("Authorization",`Bearer ${g}`);let j=await fetch(`${i}/requests/`,{method:"POST",headers:h,body:f});if(!j.ok){let a=await j.json().catch(()=>({}));throw Error(a.detail||a.message||`API Error: ${j.status}`)}return j.json()},changeRequestStatus:async(a,b,c,d)=>j(`/requests/${a}/change_status/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({to_status:b,note:c||"",...void 0!==d?{remarks:d}:{}})}),async listTeamRequests(a,b){let c=new URLSearchParams;return b?.category&&c.append("category",b.category),b?.status&&c.append("status",b.status),b?.fab_type&&c.append("fab_type",b.fab_type),b?.search&&c.append("search",b.search),b?.ordering&&c.append("ordering",b.ordering),b?.page&&c.append("page",b.page.toString()),b?.page_size&&c.append("page_size",b.page_size.toString()),j(`/teams/${a}/requests/${c.toString()?`?${c.toString()}`:""}`)}}],84120)},93107,a=>{"use strict";var b=a.i(46447),c=a.i(30564);let d=["Submitted","Processing","Issued"];function e({status:a}){return(0,b.jsx)("div",{className:"flex items-center gap-2","aria-label":"Request status progress",children:d.map((e,f)=>{let g=d.indexOf(a),h=g>=f;return(0,b.jsxs)(c.default.Fragment,{children:[(0,b.jsxs)("div",{className:`flex flex-col items-center text-[10px] font-medium ${h?"text-[#002449]":"text-gray-400"}`,children:[(0,b.jsx)("div",{className:`h-2.5 w-2.5 rounded-full ${h?g===f?"bg-[#f75700]":"bg-[#002449]":"bg-gray-300"}`}),(0,b.jsx)("span",{className:"mt-1 tracking-wide",children:e})]}),f<d.length-1&&(0,b.jsx)("div",{className:`h-px w-6 ${g>f?"bg-[#002449]":"bg-gray-300"}`,"aria-hidden":"true"})]},e)})})}a.s(["RequestProgress",()=>e])},69526,a=>{"use strict";var b=a.i(46447),c=a.i(30564),d=a.i(1470),e=a.i(35561),f=a.i(11634),g=a.i(84120),h=a.i(93107);let i=["Submitted","Processing","Issued","Cannot be Processed"],j=["BOM","ADDITIONAL","FABRICATION"];function k({currentStatus:a,onStatusChange:c,search:d,onSearch:e,category:f,onCategoryChange:g}){return(0,b.jsxs)("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[(0,b.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,b.jsx)("button",{onClick:()=>c(null),className:`px-3 py-1.5 rounded-full text-xs font-semibold border transition-colors ${null===a?"bg-[#002449] text-white border-[#002449]":"border-gray-300 text-gray-600 hover:bg-gray-50"}`,children:"All"}),i.map(d=>(0,b.jsx)("button",{onClick:()=>c(d),className:`px-3 py-1.5 rounded-full text-xs font-semibold border transition-colors ${a===d?"bg-[#f75700] text-white border-[#f75700]":"border-gray-300 text-gray-600 hover:bg-gray-50"}`,children:d},d))]}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,b.jsx)("div",{className:"relative",children:(0,b.jsx)("input",{type:"text",value:d,onChange:a=>e(a.target.value),placeholder:"Search notes...",className:"pl-3 pr-3 py-1.5 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#002449] w-48"})}),(0,b.jsxs)("select",{value:f||"",onChange:a=>g(a.target.value||null),className:"px-2 py-1.5 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#002449]",children:[(0,b.jsx)("option",{value:"",children:"All Categories"}),j.map(a=>(0,b.jsx)("option",{value:a,children:a},a))]})]})]})}var l=a.i(90599);function m(){let a=(0,d.useRouter)(),[i,j]=(0,c.useState)([]),[m,n]=(0,c.useState)(null),[o,p]=(0,c.useState)(""),[q,r]=(0,c.useState)(null),[s,t]=(0,c.useState)(!0),[u,v]=(0,c.useState)(""),w=f.authService.getCurrentUser(),x=w?.team_ids||[],y=(0,c.useCallback)(async()=>{try{if(!f.authService.getAccessToken())return void a.push("/login");if(t(!0),v(""),!x.length)return void j([]);let b=(await g.requestsService.listRequests({ordering:"-created_at"})).results.filter(a=>x.includes(a.team_id));j(b)}catch(a){console.error("[requests] single fetch error",a),v(a instanceof Error?a.message:"Failed to fetch requests")}finally{t(!1)}},[a,x]);(0,c.useEffect)(()=>{y()},[]);let z=(0,c.useMemo)(()=>i.filter(a=>(!m||a.status===m)&&(!q||a.category===q)&&(!o||!!(a.notes||"Untitled").toLowerCase().includes(o.toLowerCase()))),[i,m,q,o]),A=(0,c.useMemo)(()=>{let a={Submitted:0,Processing:0,Issued:0,Cannot:0};return i.forEach(b=>{"Submitted"===b.status?a.Submitted++:"Processing"===b.status?a.Processing++:"Issued"===b.status?a.Issued++:"Cannot be Processed"===b.status&&a.Cannot++}),a},[i]),B=a=>new Date(a).toLocaleString(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"});return(0,b.jsxs)(l.DashboardShell,{children:[(0,b.jsxs)("div",{className:"flex flex-col gap-4 mb-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("h1",{className:"text-2xl font-bold",style:{color:"#002449"},children:"My Requests"}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("button",{onClick:y,className:"px-3 py-2 text-xs font-semibold rounded-lg border border-gray-300 hover:bg-gray-50",children:"Refresh"}),(0,b.jsx)(e.default,{href:"/requests/new",className:"px-4 py-2 text-white font-medium rounded-lg transition-opacity",style:{backgroundColor:"#f75700"},onMouseEnter:a=>a.currentTarget.style.opacity="0.9",onMouseLeave:a=>a.currentTarget.style.opacity="1",children:"New Request"})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:[(0,b.jsxs)("div",{className:"p-3 rounded-lg border border-gray-200 bg-white flex flex-col",children:[(0,b.jsx)("span",{className:"text-[11px] uppercase tracking-wide text-gray-500",children:"Submitted"}),(0,b.jsx)("span",{className:"text-xl font-bold",style:{color:"#f75700"},children:A.Submitted})]}),(0,b.jsxs)("div",{className:"p-3 rounded-lg border border-gray-200 bg-white flex flex-col",children:[(0,b.jsx)("span",{className:"text-[11px] uppercase tracking-wide text-gray-500",children:"Processing"}),(0,b.jsx)("span",{className:"text-xl font-bold",style:{color:"#002449"},children:A.Processing})]}),(0,b.jsxs)("div",{className:"p-3 rounded-lg border border-gray-200 bg-white flex flex-col",children:[(0,b.jsx)("span",{className:"text-[11px] uppercase tracking-wide text-gray-500",children:"Issued"}),(0,b.jsx)("span",{className:"text-xl font-bold",style:{color:"#078e31"},children:A.Issued})]}),(0,b.jsxs)("div",{className:"p-3 rounded-lg border border-gray-200 bg-white flex flex-col",children:[(0,b.jsx)("span",{className:"text-[11px] uppercase tracking-wide text-gray-500",children:"Cannot"}),(0,b.jsx)("span",{className:"text-xl font-bold",style:{color:"#c62828"},children:A.Cannot})]})]}),(0,b.jsx)(k,{currentStatus:m,onStatusChange:n,search:o,onSearch:p,category:q,onCategoryChange:r})]}),u&&(0,b.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:(0,b.jsx)("p",{className:"text-red-800",children:u})}),s?(0,b.jsx)("div",{className:"text-center py-12",children:(0,b.jsx)("p",{className:"text-gray-600",children:"Loading requests..."})}):0===z.length?(0,b.jsxs)("div",{className:"text-center py-12",children:[(0,b.jsx)("p",{className:"text-gray-600 mb-4",children:"No requests yet"}),(0,b.jsx)(e.default,{href:"/requests/new",className:"inline-block px-4 py-2 text-white font-medium rounded-lg",style:{backgroundColor:"#f75700"},children:"Create Your First Request"})]}):(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:z.map(a=>{var c;let d="Submitted"===(c=a.status)?"#f75700":"Processing"===c?"#002449":"Issued"===c?"#078e31":"#6b7280";return(0,b.jsx)(e.default,{href:`/requests/${a.id}`,children:(0,b.jsxs)("div",{className:"group relative bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md transition cursor-pointer h-full flex flex-col",style:{boxShadow:`inset 0 0 0 2px ${d}20`},children:[(0,b.jsx)("span",{className:"absolute inset-y-0 left-0 w-1 rounded-l-lg",style:{backgroundColor:d}}),(0,b.jsxs)("div",{className:"flex items-center justify-between gap-3 mb-2",children:[(0,b.jsx)("span",{className:"px-2 py-0.5 text-[10px] font-semibold text-white rounded-md",style:{backgroundColor:"BOM"===a.category?"#002449":"ADDITIONAL"===a.category?"#007367":"#f75700"},children:a.category}),(0,b.jsx)(h.RequestProgress,{status:a.status})]}),(0,b.jsx)("h3",{className:"text-sm font-semibold text-gray-900 line-clamp-2 mb-2",children:a.notes||"Untitled"}),a.fabrication&&(0,b.jsxs)("p",{className:"text-xs text-gray-600 mb-2",children:[a.fabrication.fab_type," â€¢ ",a.fabrication.name]}),(a.bom_items?.length||0)>0&&(0,b.jsx)("div",{className:"mb-2 space-y-1 max-h-24 overflow-auto pr-0.5",children:a.bom_items.map(a=>(0,b.jsxs)("div",{className:"px-2 py-0.5 text-[10px] rounded bg-gray-100 text-gray-700 border border-gray-200 flex justify-between",children:[(0,b.jsx)("span",{className:"truncate pr-2",children:a.item_name}),(0,b.jsxs)("span",{className:"font-mono",children:["x",a.quantity]})]},a.id||a.item_name))}),(a.additional_items?.length||0)>0&&(0,b.jsx)("div",{className:"mb-2 space-y-1 max-h-24 overflow-auto pr-0.5",children:a.additional_items.map(a=>(0,b.jsxs)("div",{className:"px-2 py-0.5 text-[10px] rounded bg-gray-100 text-gray-700 border border-gray-200 flex justify-between",children:[(0,b.jsx)("span",{className:"truncate pr-2",children:a.item_name}),(0,b.jsxs)("span",{className:"font-mono",children:["x",a.quantity]})]},a.id||a.item_name))}),(0,b.jsxs)("div",{className:"mt-auto pt-2 grid grid-cols-2 gap-2 text-[10px] text-gray-600",children:[(0,b.jsxs)("div",{className:"flex flex-col",children:[(0,b.jsx)("span",{className:"font-medium text-gray-500",children:"Submitted"}),(0,b.jsx)("time",{title:a.created_at,children:B(a.created_at)})]}),(0,b.jsxs)("div",{className:"flex flex-col items-end",children:[(0,b.jsx)("span",{className:"font-medium text-gray-500",children:"Updated"}),(0,b.jsx)("time",{title:a.updated_at,children:B(a.updated_at)})]})]})]})},a.id)})})]})}a.s(["default",()=>m],69526)}];

//# sourceMappingURL=_f13296d2._.js.map