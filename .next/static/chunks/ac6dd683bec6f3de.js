(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,8915,e=>{"use strict";var s=e.i(1972),t=e.i(75305),r=e.i(30499),a=e.i(2854),l=e.i(14077),n=e.i(88771),i=e.i(88886);let d=["Submitted","Processing","Issued","Cannot be Processed"],o=["BOM","ADDITIONAL","FABRICATION"];function c({currentStatus:e,onStatusChange:t,search:r,onSearch:a,category:l,onCategoryChange:n}){return(0,s.jsxs)("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[(0,s.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,s.jsx)("button",{onClick:()=>t(null),className:`px-3 py-1.5 rounded-full text-xs font-semibold border transition-colors ${null===e?"bg-[#002449] text-white border-[#002449]":"border-gray-300 text-gray-600 hover:bg-gray-50"}`,children:"All"}),d.map(r=>(0,s.jsx)("button",{onClick:()=>t(r),className:`px-3 py-1.5 rounded-full text-xs font-semibold border transition-colors ${e===r?"bg-[#f75700] text-white border-[#f75700]":"border-gray-300 text-gray-600 hover:bg-gray-50"}`,children:r},r))]}),(0,s.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,s.jsx)("div",{className:"relative",children:(0,s.jsx)("input",{type:"text",value:r,onChange:e=>a(e.target.value),placeholder:"Search notes...",className:"pl-3 pr-3 py-1.5 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#002449] w-48"})}),(0,s.jsxs)("select",{value:l||"",onChange:e=>n(e.target.value||null),className:"px-2 py-1.5 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#002449]",children:[(0,s.jsx)("option",{value:"",children:"All Categories"}),o.map(e=>(0,s.jsx)("option",{value:e,children:e},e))]})]})]})}var x=e.i(6194);function u(){let e=(0,r.useRouter)(),[d,o]=(0,t.useState)([]),[u,m]=(0,t.useState)(null),[g,h]=(0,t.useState)(""),[p,b]=(0,t.useState)(null),[f,y]=(0,t.useState)(!0),[j,N]=(0,t.useState)(""),v=l.authService.getCurrentUser(),w=v?.team_ids||[],C=(0,t.useCallback)(async()=>{try{if(!l.authService.getAccessToken())return void e.push("/login");if(y(!0),N(""),!w.length)return void o([]);let s=(await n.requestsService.listRequests({ordering:"-created_at"})).results.filter(e=>w.includes(e.team_id));o(s)}catch(e){console.error("[requests] single fetch error",e),N(e instanceof Error?e.message:"Failed to fetch requests")}finally{y(!1)}},[e,w]);(0,t.useEffect)(()=>{C()},[]);let S=(0,t.useMemo)(()=>d.filter(e=>(!u||e.status===u)&&(!p||e.category===p)&&(!g||!!(e.notes||"Untitled").toLowerCase().includes(g.toLowerCase()))),[d,u,p,g]),_=(0,t.useMemo)(()=>{let e={Submitted:0,Processing:0,Issued:0,Cannot:0};return d.forEach(s=>{"Submitted"===s.status?e.Submitted++:"Processing"===s.status?e.Processing++:"Issued"===s.status?e.Issued++:"Cannot be Processed"===s.status&&e.Cannot++}),e},[d]),q=e=>new Date(e).toLocaleString(void 0,{year:"numeric",month:"short",day:"2-digit",hour:"2-digit",minute:"2-digit"});return(0,s.jsxs)(x.DashboardShell,{children:[(0,s.jsxs)("div",{className:"flex flex-col gap-4 mb-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold",style:{color:"#002449"},children:"My Requests"}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("button",{onClick:C,className:"px-3 py-2 text-xs font-semibold rounded-lg border border-gray-300 hover:bg-gray-50",children:"Refresh"}),(0,s.jsx)(a.default,{href:"/requests/new",className:"px-4 py-2 text-white font-medium rounded-lg transition-opacity",style:{backgroundColor:"#f75700"},onMouseEnter:e=>e.currentTarget.style.opacity="0.9",onMouseLeave:e=>e.currentTarget.style.opacity="1",children:"New Request"})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:[(0,s.jsxs)("div",{className:"p-3 rounded-lg border border-gray-200 bg-white flex flex-col",children:[(0,s.jsx)("span",{className:"text-[11px] uppercase tracking-wide text-gray-500",children:"Submitted"}),(0,s.jsx)("span",{className:"text-xl font-bold",style:{color:"#f75700"},children:_.Submitted})]}),(0,s.jsxs)("div",{className:"p-3 rounded-lg border border-gray-200 bg-white flex flex-col",children:[(0,s.jsx)("span",{className:"text-[11px] uppercase tracking-wide text-gray-500",children:"Processing"}),(0,s.jsx)("span",{className:"text-xl font-bold",style:{color:"#002449"},children:_.Processing})]}),(0,s.jsxs)("div",{className:"p-3 rounded-lg border border-gray-200 bg-white flex flex-col",children:[(0,s.jsx)("span",{className:"text-[11px] uppercase tracking-wide text-gray-500",children:"Issued"}),(0,s.jsx)("span",{className:"text-xl font-bold",style:{color:"#078e31"},children:_.Issued})]}),(0,s.jsxs)("div",{className:"p-3 rounded-lg border border-gray-200 bg-white flex flex-col",children:[(0,s.jsx)("span",{className:"text-[11px] uppercase tracking-wide text-gray-500",children:"Cannot"}),(0,s.jsx)("span",{className:"text-xl font-bold",style:{color:"#c62828"},children:_.Cannot})]})]}),(0,s.jsx)(c,{currentStatus:u,onStatusChange:m,search:g,onSearch:h,category:p,onCategoryChange:b})]}),j&&(0,s.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:(0,s.jsx)("p",{className:"text-red-800",children:j})}),f?(0,s.jsx)("div",{className:"text-center py-12",children:(0,s.jsx)("p",{className:"text-gray-600",children:"Loading requests..."})}):0===S.length?(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)("p",{className:"text-gray-600 mb-4",children:"No requests yet"}),(0,s.jsx)(a.default,{href:"/requests/new",className:"inline-block px-4 py-2 text-white font-medium rounded-lg",style:{backgroundColor:"#f75700"},children:"Create Your First Request"})]}):(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:S.map(e=>{var t;let r="Submitted"===(t=e.status)?"#f75700":"Processing"===t?"#002449":"Issued"===t?"#078e31":"#6b7280";return(0,s.jsx)(a.default,{href:`/requests/${e.id}`,children:(0,s.jsxs)("div",{className:"group relative bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md transition cursor-pointer h-full flex flex-col",style:{boxShadow:`inset 0 0 0 2px ${r}20`},children:[(0,s.jsx)("span",{className:"absolute inset-y-0 left-0 w-1 rounded-l-lg",style:{backgroundColor:r}}),(0,s.jsxs)("div",{className:"flex items-center justify-between gap-3 mb-2",children:[(0,s.jsx)("span",{className:"px-2 py-0.5 text-[10px] font-semibold text-white rounded-md",style:{backgroundColor:"BOM"===e.category?"#002449":"ADDITIONAL"===e.category?"#007367":"#f75700"},children:e.category}),(0,s.jsx)(i.RequestProgress,{status:e.status})]}),(0,s.jsx)("h3",{className:"text-sm font-semibold text-gray-900 line-clamp-2 mb-2",children:e.notes||"Untitled"}),e.fabrication&&(0,s.jsxs)("p",{className:"text-xs text-gray-600 mb-2",children:[e.fabrication.fab_type," â€¢ ",e.fabrication.name]}),(e.bom_items?.length||0)>0&&(0,s.jsx)("div",{className:"mb-2 space-y-1 max-h-24 overflow-auto pr-0.5",children:e.bom_items.map(e=>(0,s.jsxs)("div",{className:"px-2 py-0.5 text-[10px] rounded bg-gray-100 text-gray-700 border border-gray-200 flex justify-between",children:[(0,s.jsx)("span",{className:"truncate pr-2",children:e.item_name}),(0,s.jsxs)("span",{className:"font-mono",children:["x",e.quantity]})]},e.id||e.item_name))}),(e.additional_items?.length||0)>0&&(0,s.jsx)("div",{className:"mb-2 space-y-1 max-h-24 overflow-auto pr-0.5",children:e.additional_items.map(e=>(0,s.jsxs)("div",{className:"px-2 py-0.5 text-[10px] rounded bg-gray-100 text-gray-700 border border-gray-200 flex justify-between",children:[(0,s.jsx)("span",{className:"truncate pr-2",children:e.item_name}),(0,s.jsxs)("span",{className:"font-mono",children:["x",e.quantity]})]},e.id||e.item_name))}),(0,s.jsxs)("div",{className:"mt-auto pt-2 grid grid-cols-2 gap-2 text-[10px] text-gray-600",children:[(0,s.jsxs)("div",{className:"flex flex-col",children:[(0,s.jsx)("span",{className:"font-medium text-gray-500",children:"Submitted"}),(0,s.jsx)("time",{title:e.created_at,children:q(e.created_at)})]}),(0,s.jsxs)("div",{className:"flex flex-col items-end",children:[(0,s.jsx)("span",{className:"font-medium text-gray-500",children:"Updated"}),(0,s.jsx)("time",{title:e.updated_at,children:q(e.updated_at)})]})]})]})},e.id)})})]})}e.s(["default",()=>u],8915)}]);